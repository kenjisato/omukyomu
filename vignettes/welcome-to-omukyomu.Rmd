---
title: "R for 教務"
author: "Kenji Sato"
date: "2023-04-13"
output: 
  rmarkdown::html_vignette:
    toc: yes
vignette: >
  %\VignetteIndexEntry{welcome-to-omukyomu}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

## 目的

この R パッケージ^[パッケージとは R の機能を拡張するソフトウェアのことです。]の目的は、大阪公立大学経済学部教務委員および
教務事務（教務担当者）の業務負担を軽減することです。
定期的に発生するルーチーンワークをコード化してパッケージングすることで、
業務時間の短縮を図ります。

R を使ったことがない方が教務担当になることも想定して、コマンド類を整理しています。

## R のインストール

最初の準備として、[R](https://cran.rstudio.com/) をインストールしてください。[RStudio Desktop](https://posit.co/download/rstudio-desktop/) のインストールも強く推奨しますが、絶対に必要という訳ではありません。

事務端末にインストールする場合、システム管理者に依頼して一時的に制限解除してもらう必要があるかもしれません。


### R のコマンド

R を起動すると、R のバージョン、著作権表示等が記された文字だけのウインドウ（**コンソール**といいます）が現れて、その一番下に、次のような記号が表示されます。

```{r, eval = FALSE}
> 
```

この記号は「**プロンプト**」と言って、R がユーザーからの入力を待っている状態を表しています。
この資料で、「**コマンドを実行する**」と言った場合、指定されたコマンド（R に対する命令を表すテキスト）をこの部分にコピー＆ペーストしてから、必要に応じて一部書き換えて、Enter キーを押す、という操作を行います。

コマンドをいくつか実行すると `>` がいくつも並ぶことがあります。

```
> command()
>
> 
```

一番下の行だけが入力を受け付けている状態になっています。見失ってしまった場合は、ウインドウの一番下まで移動してください。

## omukyomu のインストール

このパッケージは GitHub というサイトを利用してソースコードを公開しています。R を起動して、

- GitHub 上のパッケージのインストールをサポートしてくれる **remotes** パッケージをインストールする。
- GitHub から **omukyomu** をインストールする。

まず、**remotes** のインストールです。このパッケージは R のインストール後に一度行えば十分でしょう。

```{r, eval = FALSE}
install.packages("remotes", repos = "https://cloud.r-project.org/")
```

ただし、次のコマンドが失敗するようになったら再インストールが必要かもしれません。その時はもう一度、上のコマンドを実行してください。

続いて、**omukyomu** パッケージをインストールします。

```{r, eval = FALSE}
remotes::install_github("kenjisato/omukyomu")
```

このパッケージは、教務業務に必要なその他のパッケージをまるごとインストールするように設定されています。最初の実行には時間がかかるかもしれません。

## 大きな仕事

### 1・2年次向け演習科目の登録状況の集計



### ゼミ募集

毎年の大きな業務の1つに専門演習の募集があります。

次の手順で進めることになります。星をつけた部分が、このパッケージを用いて若干の負担軽減が期待できる業務です。

1. プロジェクト申請を行う（教務事務→ヘルプデスク）
2. 昨年度のMoodle サイトから情報をインポートする（教務担当）
3. 日程等情報の年度更新を行う
4. ☆ 教員をMoodleに登録する（教務事務→ヘルプデスク）
5. ✎ ゼミ紹介ページを更新する（各教員）
6. 学生をMoodleに登録する（教務事務）
7. 説明会
8. ☆ 学生希望調査の回収 → マッチング用のランク表に変換
9. ☆ 教員による評価の回収 → マッチング用のランク表に変換
10. ☆ マッチングアルゴリズムの実行
11. 結果発表、2次募集、その他

なお、✎ の部分には、[**omueconApp**](https://github.com/kenjisato/omueconApp) を用いることができます。Markdown から Moodle ページ用のHTML が生成できる ウェブアプリです。クラウド上のアプリも使用できます。  https://kjst.shinyapps.io/omueconapp


### R の外での準備



Excel ファイルで教員陣の名簿を作成してください。

| 氏名      | ページタイトル | Email                | OMUID   | MoodleId |
|-----------|----------------|----------------------|---------|----------|
| 公大 花子 | 公大花子ゼミ   | kodai@example.com    | k*****a | 12345    |
| 杉本 太郎 | 杉本 太郎      | sugimoto@example.com | s*****b | 56789    |




```{r setup}
library(omukyomu)
```



